<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="ISO-8859-1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>Spring Boot Gallery App</title>
	<link rel="stylesheet" href="/webjars/bootstrap/css/bootstrap.min.css"/>
	<link rel="stylesheet" href="/style.css">
	<script type="text/javascript" src="/webjars/jquery/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.0.4/popper.js"></script>
	<script type="text/javascript" src="/webjars/bootstrap/js/bootstrap.min.js"></script>
</head>
<body>
<div class="main_container">
	<div class="display_time">
		<div id="datetime">8:30pm</div>
	</div>
	<div class="dropdown">
		<button th:if="${#request.userPrincipal == null}"  class="btn btn-info dropdown-toggle" type="button" id="menuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			Menu
		</button>
		<button th:if="${#request.userPrincipal != null}" class="btn btn-info dropdown-toggle" type="button" id="menuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			[[${#request.userPrincipal.principal.fullName}]]
		</button>
		<div class="dropdown-menu" aria-labelledby="menuButton">
			<a class="dropdown-item" th:href="@{/}">Home</a>
			<a class="dropdown-item" th:href="@{/galleries}">Galleries</a>
			<a th:if="${#request.userPrincipal != null}" class="dropdown-item" th:href="@{/settings}">Settings</a>
			<a th:if="${#request.userPrincipal == null}" class="dropdown-item" th:href="@{/login}">Sign In</a>
			<a th:if="${#request.userPrincipal != null}" class="dropdown-item" th:href="@{/logout}">Sign out</a>
		</div>
	</div>
</div>
<div class="subcontent">
	<h2 class="text-center">Photo Galleries</h2>
	<div>
		<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteModal">
			Delete Album
		</button>
		<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#renameModal">
			Rename Album
		</button>
		<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#uploadModal">
			Upload Photos
		</button>
		
	</div>
	<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog"  aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="deleteModalLongTitle">Delete Album</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<p>Are you sure you want to delete this Album?</p>
				</div>
				<div class="modal-footer">
					<form method="post"
						  th:action="@{'/gallery/' + ${gallery.getId()} + '/delete'}">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
						<button type="submit" class="btn btn-primary">Yes, Delete Album</button>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" id="renameModal" tabindex="-1" role="dialog"  aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="renameModalLongTitle">Rename Album</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<form method="post"
						   th:action="@{'/gallery/' + ${gallery.getId()} + '/rename'}">
						<div class="form-group column">
							<input id="galleryname" name="galleryname" type="text" class="form-control"
								   required minlength="2" maxlength="20">
							<button type="submit" class="btn btn-primary">Rename</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" id="uploadModal" tabindex="-1" role="dialog"  aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLongTitle">Upload Photos</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<form  method="post" enctype="multipart/form-data"
						   th:action="@{'/gallery/' + ${gallery.getId()} + '/image'}">
						<label class="control-label">Select Image to upload</label>
						<input id="imagefile" name="imagefile" type="file" class="file">
						<button type="submit" class="btn btn-primary">Upload</button>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" id="imageViewerModal" tabindex="-1" role="dialog"  aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-body">
					<div id="carouselViewer" class="carousel slide" data-ride="carousel">
						<div class="carousel-inner">
							<div class="carousel-item" th:each="photo, iterStat : ${gallery.galleryPhotos}" th:classappend="${iterStat.index == 0}? 'active'" >
								<img  class="d-inline-block w-100" th:src="@{'/gallery/' + ${gallery.getId()} + '/image/'+ ${photo.getId()}}">
								<form method="post"
									  th:action="@{'/image/' + ${photo.getId()} + '/delete'}">
									<div class="deleteHolder">
										<button type="submit" class="btn btn-danger">Delete</button>
									</div>
								</form>
							</div>
						</div>
						<a class="carousel-control-prev" href="#carouselViewer" role="button" data-slide="prev">
							<span class="carousel-control-prev-icon" aria-hidden="true"></span>
							<span class="sr-only">Previous</span>
						</a>
						</a>
						<a class="carousel-control-next" href="#carouselViewer" role="button" data-slide="next">
							<span class="carousel-control-next-icon" aria-hidden="true"></span>
							<span class="sr-only">Next</span>
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="sub_container">
	<div class="lightbox-gallery centerContent">
		<div class="row photos" data-toggle="modal" data-target="#imageViewerModal">
			<div class="photos" th:each="photo: ${gallery.galleryPhotos}">
				<img  id="images" data-target=?#carouselViewer?  class="img-thumbnail rounded" th:alt="${photo.name}" th:src="@{'/gallery/' + ${gallery.getId()} + '/image/'+ ${photo.getId()}}">
			</div>
		</div>
	</div>
</div>

<script type="text/javascript" th:src="@{/js/dropdown.js}"></script>
</body>
</html>
